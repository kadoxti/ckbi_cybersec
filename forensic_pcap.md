# Шпаргалка по форензике в Wireshark

## Первые шаги

### Статистика

В окне `Statistics->Capture File Properties` можно посмотреть общую информацию: время первого и последнего пакетов.

В окне `Statistics->Conversations` можно увидеть обмен между адресами и отсортировать по количеству пакетов.

### TLS хэндшейки
Можно начать с фильтра `tls.handshake.type == 1`, который показывает успешные соединения по протоколу tls.

Для расшифровки TLS понадобится Pre-master secret (PMS). Его можно найти по адресу, который указан в переменной окружения `SSLKEYLOGFILE`. Если файл найден, то его можно скормить Wireshark.

### Изоляция обмена

Если вдруг надо изолировать обмен между двумя ip, то можно применить фильтр:
`(ip.src == ip1 && ip.dst == ip2) || (ip.src == ip2 && ip.dst == ip1)`

Например: `(ip.src == 192.168.241.128 && ip.dst == 192.168.241.129) || (ip.src == 192.168.241.129 && ip.dst == 192.168.241.128)`

### Изоляция протокола

Иногда бывает полезно отфильтровать пакеты по протоколу: `_ws.col.protocol == "TCP"`.

Если анализируется веб-сайт, то более информативным будет анализ http обмена: `_ws.col.protocol == "HTTP"`
