# Лекция № 3

Чтобы получить доступ к файлам в Linux, используются разрешения. Эти разрешения назначаются трем объектам: файлу, группе и другому объекту (то есть всем остальным)

## Утилита chmod

Команда `ls -l` выводит много информации о правах доступа к каждому файлу:

```
$ ls -l
  -rwxr-x--x  1  user  group  1097374 January 26 2:48 test.sh
  drw-rw-r--  1  user  group  1097374 January 26 2:48 testdir
```

Самый первый символ: `-` - признак файла, `d` - признак папки.  
Далее три группы прав: владельца, группы, остальных.  
`r` - чтение, `w` - запись, `x` - исполнение.

Для файла test.sh установлены следующие права:
- Владелец может читать, изменять и выполнять файл
- Члены группы могут только читать и выполнять файл
- Остальные пользователи могут только выполнять файл
  
`chmod` можно использовать с восьмеричными числами, где 1 — это наличие прав, а 0 — отсутствие:

```
rwx = 111 = 7
rw- = 110 = 6
r-x = 101 = 5
r-- = 100 = 4
```

## Специальные разрешения

Помимо битов стандартных прав `r,w,x`, существуют биты `s` и `t`.

- `s` - в разделе прав пользователя это бит SUID. The process running the file will have the owner’s user ID instead of the current user’s ID. Пример использования: `chmod u+s test.sh`. Результат: `-rwsr-x--x`
- `s` - в разделе прав группы это бит SGID. The process running the file will have the file’s group ID. Пример использования: `chmod g+s test.sh`. Результат: `-rwxr-s--x`
- `t` - это бит Sticky Bit. This bit applies only to directories. It prevents users from deleting files they don’t own within the directory unless they are the owner of the directory or have root privileges. Пример использования: `chmod +t testdir`. Результат: `drw-rw-r--t`

Бит смены владельца или **SUID (Set User ID)** — это разрешение файловой системы Linux, которое позволяет запустить исполняемый файл от имени его владельца. Он нужен, потому что многие действия в Linux (например, открытие «сырого» сетевого сокета) требуют прав суперпользователя. Хорошо знакомая всем команда ping использует сетевые сокеты и поэтому должна быть запущена от root’а. Каким образом можно позволить обычному пользователю применять команду ping? Можно выдать пользователю sudo на необходимые команды. Но представьте, что на условной Linux-машине имеется 100 пользователей и насчитывается около 20 привилегированных команд. А как потом управлять разрешениями sudo на все это «богатство»? Не самое элегантное решение, не правда ли? С другой стороны, бит смены владельца значительно упрощает процесс. Бит смены владельца сообщит системе, что все 100 пользователей системы запускают команду ping от имени root. Еще пример утилита `passwd`, которая изменяет файлы /etc/passwd и /etc/shadow, доступные только root'у.


## Другое

`find / -user linda` - вывод всех файлов, для которых linda владелец
`find / -group users`

`chown -R linda /home/account` - смена владельца для папки и всего содержимого

## Утилита chown

## Утилита chgrp

## Утилита touch

## Материалы

- https://habr.com/ru/companies/jetinfosystems/articles/506750/
- https://habr.com/ru/articles/469667/

