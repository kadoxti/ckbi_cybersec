# Лекций № 2

## Утилита ls

Назначение утилиты ls – отображать информацию о директориях (каталогах) и файлах, находящихся в папках.

`ls` - без указания папки выведет все файлы и папки в текущей директории  
`ls /bin/` - все файлы и папки в директории bin  
`ls -a /bin/` - выводит в том числе все, что начинается с точки (например `.vscode/`)  
`ls -A /bin/` - выводит в том числе все, что начинается с точки (например `.vscode/`), но без `.` и `..`  
`ls -R /bin/` - рекурсия  
`ls -l` - вывод дополнительной информации о файлах и папках  
`ls -m` - разделение элементов списка запятой. Может быть удобно для вывода в csv файл  
`ls -1` - в каждой отдельной строке отображать информацию только по одному объекту  
`ls -H` - вывод информации по ссылкам  
`ls -h` - размер файлов в удобном формате  
`ls -р` – если объект является директорией, то при выводе в конце названия отобразиться слэш.

`ls -lAHhpR` - команда хацкера

Вывод `ls -l`:

- Тип файла:
  - `-` - Regular file.
  - `b` - Block special file.
  - `c` - Character special file.
  - `d` - Directory.
  - `l` - Symbolic link.
  - `n` - Network file.
  - `p` - FIFO.
  - `s` - Socket.
- Разрешения - как в chmod
- Количество жестких ссылок (символические не считаются)
- Владелец файла
- Группа файла
- Размер
- Дата и время изменения файла
- Имя файла

Пример вывода `ls -l`:
`-rw-r--r-- 5 root root 337 Oct  4 11:31 /etc/hosts` - hosts - обычный файл, с правами `rw-r--r--`, 5 жестких ссылок, владелец root, группа root, размером 337 байт, последнее изменение 4 октября в 11:31.

Иногда в разрешениях в конце можно встретить `+`, например `rw-r--r--+`, что означает, что к файлу дополнительно применяется ACL (access control list)

Иногда в разрешениях к директории в конце можно встретить `t`, например `rw-r--r--t`, что означает, что удалять файлы в директории могут только владелец директории, владелец файла или root. 

## Утилита mkdir

`mkdir` - создает папки.  
`mkdir -p` - создает все промежуточные папки  
`mkdir -m` - задает режим выдачи прав на созданные папки в формате chmod  
`mkdir dir_1 dir_2 dir_3` - можно создать несколько директорий

## Утилита rmdir

`rmdir` - удаляет папки.  
`rmdir -p /first/second/` - удаляет все промежуточные папки (включая first)  
`rmdir dir_1 dir_2 dir_3` - можно удалить несколько директорий

Утилита не сможет удалить непустую папку!

## Утилита cp

`cp dir1/file.txt dir2/file2.txt` - копирует файл

Нюансы:
- Если dir2 не существует, то операция не выполнится
- если file2.txt уже существует, то он будет молча перезаписан

`cp dir1/file.txt dir2/` - копирует файл в папку dir2 с тем же именем (file.txt)  
`cp dir1/file.txt 1.txt /tmp/2.so dir2/` - копирует несколько файлов в папку dir2

`cp -f` - если файл назначения уже существует, но нет прав на запись в него, то он будет удален и далее стандартная процедура копирования

`cp src/* dst` - скопирует все файлы из src, но не скопирует папки

`cp -r src dst` - если dst существует, то копирует src внутрь dst, тоесть будет структура dst->src. Если dst не существует, то dst создастся и содержимое src скопируется внутрь dst (без самой папки src). Копирует в том числе и папки.

`cp -rT src dst` - даже если dst существует, то копируется только содержимое src, а не сама папка src

### Бэкапы

`cp -u` - заменять только если файл источник новее или файл в папке назначения не существует (--upgrade)

`cp -b` - если файл назначения уже существует, то предварительно делается его копия со знаком ~. Только после этого происходит перезаписывание

`cp --backup`

При использовании опции --backup можно настроить имя резервной копии, Вот доступные варианты:

- **none** - резервная копия не делается;
- **numbered** - к имени файла будет добавляться номер;
- **simple** - в конец файла будет добавлен знак ~;
- **existing** - если в директории назначения уже есть резервные копии, то будет использоваться такой же тип именования как и у них.

Пример:
`cp --backup=numbered src dst`

## Утилита mv

`mv` - перемещает и переименовывает файл.  
`mv -f` - не спрашить, если файл уже существует. Насильно перезаписывает  

## Утилита rm

`rm` - удаляет файлы.    
`rm -d` - удаляет в т.ч. папки.  
`rm -f` - удаление без всяких вопросов  
`rm -r` - рекурсивное удаление файлов (применяется вместе с флагом `-d`

`rm -dfr /dir_1` - удалит все файлы и папки в папке dir_1 и саму dir_1

В Linux нет корзины, поэтому удаление файлов и папок не откатывается!

## Задание 1

Скрипт, который создает в заданной пользователем папке 10 папок и 10 подпапок в каждой. Если в заданной папке есть файлы, то скрипт копирует всех их в подпапки. 

## Задание 2

Скрипт, который удаляет все в заданной пользователем папке, но не удаляет саму папку

## Источники

- https://linuxize.com/post/how-to-list-files-in-linux-using-the-ls-command/
- https://losst.pro/komanda-cp-v-linux
- https://www.geeksforgeeks.org/cp-command-linux-examples/
